// db
const database = "mongoDB";
const div = "itQuiz";
const userName = "hong";
const strDate = "2025-10-10 09:00";

// Select the database to use.
use(database)

// // get indexes
// db.ranking.getIndexes();

// // insert documents
// db.ranking.insertMany([
//     { sDiv: div, nRank: 1, nScore: 100, sUserName: userName, dUpdateDate: new Date(strDate) },
//     { sDiv: div, nRank: 1, nScore: 100, sUserName: userName, dUpdateDate: new Date("2025/10/02 09:00") },
//     { sDiv: div, nRank: 1, nScore: 100, sUserName: userName, dUpdateDate: new Date("2025/10/03 09:00") },
//     { sDiv: div, nRank: 4, nScore: 95, sUserName: userName, dUpdateDate: new Date("2025/10/04 09:00") },
//     { sDiv: div, nRank: 5, nScore: 90, sUserName: userName, dUpdateDate: new Date("2025/10/05 09:00") },
// ]);

// find documents
cond = { sDiv: { $eq: div } };
selectData = {
    _id: 0,
    nRank: 1,
    nScore: 1,
    sUserName: 1,
    dUpdateDate: {
        $dateToString: {
            format: "%Y/%m/%d %H:%M",
            date: "$dUpdateDate"
        }
    }
};
sortData = { nRank: 1, dUpdateDate: -1 };

db.ranking.find(cond, selectData).sort(sortData).limit(5).pretty();

// update document
// db.ranking.updateMany(
//     { nRank: { $gte: 3 } },
//     {
//         $inc: {
//             nRank: 1 // 順位 (nRank) を 1 増やす (+1)
//         }
//     }
// );
